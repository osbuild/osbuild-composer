dist: bionic
addons:
  apt:
    packages:
      - systemd-container
      - qemu-utils
      - yum
      - gnupg2
matrix:
  include:
    - language: go
      go: 1.12.x
      env: GO111MODULE=on # needed even for Go 1.12
      script: go test -v ./...

    - language: python
      python: 3.7
      env: PYTHONUNBUFFERED=1
      script:
        # ubuntu's rpm package sets dbpath to ~/.rpmdb, which makes rpm fail...
        - sudo sh -c 'mkdir /etc/rpm; echo "%_dbpath /var/lib/rpm" > /etc/rpm/macros'
        - sudo env "PATH=$PATH" "OSBUILD_TEST_BUILD_PIPELINE=tools/test_image_info/build-from-yum.json" python3 -m unittest tools.test_image_info
